!function(i){var t=window.webpackHotUpdate;window.webpackHotUpdate=function(i,s){!function(i,t){if(!w[i]||!f[i])return;for(var s in f[i]=!1,t)Object.prototype.hasOwnProperty.call(t,s)&&(m[s]=t[s]);0==--y&&0===P&&x()}(i,s),t&&t(i,s)};var s,e=!0,o="a62b0c060f4fcd71cf70",h={},n=[],r=[];function a(i){var t=A[i];if(!t)return X;var e=function(e){return t.hot.active?(A[e]?-1===A[e].parents.indexOf(i)&&A[e].parents.push(i):(n=[i],s=e),-1===t.children.indexOf(e)&&t.children.push(e)):(console.warn("[HMR] unexpected require("+e+") from disposed module "+i),n=[]),X(e)},o=function(i){return{configurable:!0,enumerable:!0,get:function(){return X[i]},set:function(t){X[i]=t}}};for(var h in X)Object.prototype.hasOwnProperty.call(X,h)&&"e"!==h&&"t"!==h&&Object.defineProperty(e,h,o(h));return e.e=function(i){return"ready"===c&&u("prepare"),P++,X.e(i).then(t,(function(i){throw t(),i}));function t(){P--,"prepare"===c&&(M[i]||v(i),0===P&&0===y&&x())}},e.t=function(i,t){return 1&t&&(i=e(i)),X.t(i,-2&t)},e}function l(t){var e={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_selfInvalidated:!1,_disposeHandlers:[],_main:s!==t,active:!0,accept:function(i,t){if(void 0===i)e._selfAccepted=!0;else if("function"==typeof i)e._selfAccepted=i;else if("object"==typeof i)for(var s=0;s<i.length;s++)e._acceptedDependencies[i[s]]=t||function(){};else e._acceptedDependencies[i]=t||function(){}},decline:function(i){if(void 0===i)e._selfDeclined=!0;else if("object"==typeof i)for(var t=0;t<i.length;t++)e._declinedDependencies[i[t]]=!0;else e._declinedDependencies[i]=!0},dispose:function(i){e._disposeHandlers.push(i)},addDisposeHandler:function(i){e._disposeHandlers.push(i)},removeDisposeHandler:function(i){var t=e._disposeHandlers.indexOf(i);t>=0&&e._disposeHandlers.splice(t,1)},invalidate:function(){switch(this._selfInvalidated=!0,c){case"idle":(m={})[t]=i[t],u("ready");break;case"ready":T(t);break;case"prepare":case"check":case"dispose":case"apply":(g=g||[]).push(t)}},check:S,apply:E,status:function(i){if(!i)return c;p.push(i)},addStatusHandler:function(i){p.push(i)},removeStatusHandler:function(i){var t=p.indexOf(i);t>=0&&p.splice(t,1)},data:h[t]};return s=void 0,e}var p=[],c="idle";function u(i){c=i;for(var t=0;t<p.length;t++)p[t].call(null,i)}var d,m,_,g,y=0,P=0,M={},f={},w={};function C(i){return+i+""===i?+i:i}function S(i){if("idle"!==c)throw new Error("check() is only allowed in idle status");return e=i,u("check"),(t=1e4,t=t||1e4,new Promise((function(i,s){if("undefined"==typeof XMLHttpRequest)return s(new Error("No browser support"));try{var e=new XMLHttpRequest,h=X.p+""+o+".hot-update.json";e.open("GET",h,!0),e.timeout=t,e.send(null)}catch(i){return s(i)}e.onreadystatechange=function(){if(4===e.readyState)if(0===e.status)s(new Error("Manifest request to "+h+" timed out."));else if(404===e.status)i();else if(200!==e.status&&304!==e.status)s(new Error("Manifest request to "+h+" failed."));else{try{var t=JSON.parse(e.responseText)}catch(i){return void s(i)}i(t)}}}))).then((function(i){if(!i)return u(b()?"ready":"idle"),null;f={},M={},w=i.c,_=i.h,u("prepare");var t=new Promise((function(i,t){d={resolve:i,reject:t}}));m={};return v(0),"prepare"===c&&0===P&&0===y&&x(),t}));var t}function v(i){w[i]?(f[i]=!0,y++,function(i){var t=document.createElement("script");t.charset="utf-8",t.src=X.p+""+i+"."+o+".hot-update.js",document.head.appendChild(t)}(i)):M[i]=!0}function x(){u("ready");var i=d;if(d=null,i)if(e)Promise.resolve().then((function(){return E(e)})).then((function(t){i.resolve(t)}),(function(t){i.reject(t)}));else{var t=[];for(var s in m)Object.prototype.hasOwnProperty.call(m,s)&&t.push(C(s));i.resolve(t)}}function E(t){if("ready"!==c)throw new Error("apply() is only allowed in ready status");return function t(e){var r,a,l,p,c;function d(i){for(var t=[i],s={},e=t.map((function(i){return{chain:[i],id:i}}));e.length>0;){var o=e.pop(),h=o.id,n=o.chain;if((p=A[h])&&(!p.hot._selfAccepted||p.hot._selfInvalidated)){if(p.hot._selfDeclined)return{type:"self-declined",chain:n,moduleId:h};if(p.hot._main)return{type:"unaccepted",chain:n,moduleId:h};for(var r=0;r<p.parents.length;r++){var a=p.parents[r],l=A[a];if(l){if(l.hot._declinedDependencies[h])return{type:"declined",chain:n.concat([a]),moduleId:h,parentId:a};-1===t.indexOf(a)&&(l.hot._acceptedDependencies[h]?(s[a]||(s[a]=[]),y(s[a],[h])):(delete s[a],t.push(a),e.push({chain:n.concat([a]),id:a})))}}}}return{type:"accepted",moduleId:i,outdatedModules:t,outdatedDependencies:s}}function y(i,t){for(var s=0;s<t.length;s++){var e=t[s];-1===i.indexOf(e)&&i.push(e)}}b();var P={},M=[],f={},S=function(){console.warn("[HMR] unexpected require("+x.moduleId+") to disposed module")};for(var v in m)if(Object.prototype.hasOwnProperty.call(m,v)){var x;c=C(v),x=m[v]?d(c):{type:"disposed",moduleId:v};var E=!1,T=!1,I=!1,O="";switch(x.chain&&(O="\nUpdate propagation: "+x.chain.join(" -> ")),x.type){case"self-declined":e.onDeclined&&e.onDeclined(x),e.ignoreDeclined||(E=new Error("Aborted because of self decline: "+x.moduleId+O));break;case"declined":e.onDeclined&&e.onDeclined(x),e.ignoreDeclined||(E=new Error("Aborted because of declined dependency: "+x.moduleId+" in "+x.parentId+O));break;case"unaccepted":e.onUnaccepted&&e.onUnaccepted(x),e.ignoreUnaccepted||(E=new Error("Aborted because "+c+" is not accepted"+O));break;case"accepted":e.onAccepted&&e.onAccepted(x),T=!0;break;case"disposed":e.onDisposed&&e.onDisposed(x),I=!0;break;default:throw new Error("Unexception type "+x.type)}if(E)return u("abort"),Promise.reject(E);if(T)for(c in f[c]=m[c],y(M,x.outdatedModules),x.outdatedDependencies)Object.prototype.hasOwnProperty.call(x.outdatedDependencies,c)&&(P[c]||(P[c]=[]),y(P[c],x.outdatedDependencies[c]));I&&(y(M,[x.moduleId]),f[c]=S)}var L,V=[];for(a=0;a<M.length;a++)c=M[a],A[c]&&A[c].hot._selfAccepted&&f[c]!==S&&!A[c].hot._selfInvalidated&&V.push({module:c,parents:A[c].parents.slice(),errorHandler:A[c].hot._selfAccepted});u("dispose"),Object.keys(w).forEach((function(i){!1===w[i]&&function(i){delete installedChunks[i]}(i)}));var k,z,R=M.slice();for(;R.length>0;)if(c=R.pop(),p=A[c]){var W={},j=p.hot._disposeHandlers;for(l=0;l<j.length;l++)(r=j[l])(W);for(h[c]=W,p.hot.active=!1,delete A[c],delete P[c],l=0;l<p.children.length;l++){var H=A[p.children[l]];H&&((L=H.parents.indexOf(c))>=0&&H.parents.splice(L,1))}}for(c in P)if(Object.prototype.hasOwnProperty.call(P,c)&&(p=A[c]))for(z=P[c],l=0;l<z.length;l++)k=z[l],(L=p.children.indexOf(k))>=0&&p.children.splice(L,1);u("apply"),void 0!==_&&(o=_,_=void 0);for(c in m=void 0,f)Object.prototype.hasOwnProperty.call(f,c)&&(i[c]=f[c]);var D=null;for(c in P)if(Object.prototype.hasOwnProperty.call(P,c)&&(p=A[c])){z=P[c];var G=[];for(a=0;a<z.length;a++)if(k=z[a],r=p.hot._acceptedDependencies[k]){if(-1!==G.indexOf(r))continue;G.push(r)}for(a=0;a<G.length;a++){r=G[a];try{r(z)}catch(i){e.onErrored&&e.onErrored({type:"accept-errored",moduleId:c,dependencyId:z[a],error:i}),e.ignoreErrored||D||(D=i)}}}for(a=0;a<V.length;a++){var B=V[a];c=B.module,n=B.parents,s=c;try{X(c)}catch(i){if("function"==typeof B.errorHandler)try{B.errorHandler(i)}catch(t){e.onErrored&&e.onErrored({type:"self-accept-error-handler-errored",moduleId:c,error:t,originalError:i}),e.ignoreErrored||D||(D=t),D||(D=i)}else e.onErrored&&e.onErrored({type:"self-accept-errored",moduleId:c,error:i}),e.ignoreErrored||D||(D=i)}}if(D)return u("fail"),Promise.reject(D);if(g)return t(e).then((function(i){return M.forEach((function(t){i.indexOf(t)<0&&i.push(t)})),i}));return u("idle"),new Promise((function(i){i(M)}))}(t=t||{})}function b(){if(g)return m||(m={}),g.forEach(T),g=void 0,!0}function T(t){Object.prototype.hasOwnProperty.call(m,t)||(m[t]=i[t])}var A={};function X(t){if(A[t])return A[t].exports;var s=A[t]={i:t,l:!1,exports:{},hot:l(t),parents:(r=n,n=[],r),children:[]};return i[t].call(s.exports,s,s.exports,a(t)),s.l=!0,s.exports}X.m=i,X.c=A,X.d=function(i,t,s){X.o(i,t)||Object.defineProperty(i,t,{enumerable:!0,get:s})},X.r=function(i){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},X.t=function(i,t){if(1&t&&(i=X(i)),8&t)return i;if(4&t&&"object"==typeof i&&i&&i.__esModule)return i;var s=Object.create(null);if(X.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:i}),2&t&&"string"!=typeof i)for(var e in i)X.d(s,e,function(t){return i[t]}.bind(null,e));return s},X.n=function(i){var t=i&&i.__esModule?function(){return i.default}:function(){return i};return X.d(t,"a",t),t},X.o=function(i,t){return Object.prototype.hasOwnProperty.call(i,t)},X.p="",X.h=function(){return o},a(0)(X.s=0)}([function(i,t,s){"use strict";s.r(t);class e extends XE.Obj.PlotBase{constructor(i,t){function s(t,s,e){if(s){var o=Cesium.Cartesian3.distance(t.camera.positionWC,s),h={name:"距离测量",position:s,clampToGround:!0,attachPolygon:!0,label:{text:e,translucencyByDistance:new Cesium.NearFarScalar(5*o,2,30*o,0),style:Cesium.LabelStyle.FILL_AND_OUTLINE,font:"35px 楷体",fillColor:Cesium.Color.WHITE.withAlpha(.9),outlineColor:Cesium.Color.BLACK.withAlpha(.9),outlineWidth:6,disableDepthTestDistance:1e9,scale:.5,pixelOffset:new Cesium.Cartesian2(0,-10),verticalOrigin:Cesium.VerticalOrigin.BOTTOM}};return i.czm.viewer.entities.add(h)}}function e(i,t,s){i.position=t,i.label.text=s}super(i,t),this._onlyMove=!1,this._fixedPositionsNum=void 0,XE.MVVM.extend(this,{_polylineShow:!0}),this._polyline=new XE.Obj.Polyline(i),this.disposers.push(()=>{this._polyline=this._polyline&&this._polyline.destroy()}),this._polyline.show=this._polylineShow&&this.show,XE.Earth.Interaction.Picking.registerPickingParent(this._polyline,this),this._labels=[],this._totalLabel=void 0;const o=()=>{this._polyline.show=this._polylineShow&&this.show,this._polyline.width=this.width,this._polyline.material.XbsjColorMaterial.color=this.color,this._polyline.ground=this.ground,this._polyline.depthTest=this.depthTest,this._polyline.minShowHeight=this.minShowHeight,this._polyline.maxShowHeight=this.maxShowHeight;const t=this.positions.map(i=>Cesium.Cartesian3.fromRadians(...i));this._labels.forEach(i=>i.show=this.showLength&&this.show),this._totalLabel&&(this._totalLabel.show=this.showLength&&this.show),function(i,t){for(var s=i.length,e=0;e<s-1;++e){var o=i[e],n=i[e+1],r=Cesium.Cartesian3.distance(o,n);t(e,r,Cesium.Cartesian3.lerp(o,n,.5,new Cesium.Cartesian3),h(r))}}(t,(t,o,h,n)=>{void 0===this._labels[t]?this._labels[t]=s(i.czm.viewer,h,n):e(this._labels[t],h,n)});let o=function(i){for(var t=0,s=i.length,e=0;e<s-1;++e)t+=Cesium.Cartesian3.distance(i[e],i[e+1]);return t}(t);void 0===this._totalLabel?this._totalLabel=s(i.czm.viewer,t[0],"总长:"+h(o)):e(this._totalLabel,t[0],"总长:"+h(o));let n=this.positions.length;for(var r=n-1<0?0:n-1;r<this._labels.length;++r)this._labels[r].show=!1};function h(i){return i>1e3?(i/1e3).toFixed(3)+"千米":i.toFixed(3)+"米"}o(),this.disposers.push(XE.MVVM.watch(()=>({show:this.show,polylineShow:this._polylineShow,width:this.width,color:[...this.color],ground:this.ground,depthTest:this.depthTest,minShowHeight:this.minShowHeight,maxShowHeight:this.maxShowHeight,positions:[...this.positions],showLength:this.showLength}),()=>o()),()=>{this._labels.forEach(t=>i.czm.viewer.entities.remove(t)),i.czm.viewer.entities.remove(this._totalLabel)})}get onlyMove(){return this._onlyMove}get fixedPositionsNum(){return this._fixedPositionsNum}flyTo(){this._polyline.flyTo()}}e.defaultOptions={positions:[],show:!0,width:5,color:[0,1,0,1],depthTest:!1,minShowHeight:-Number.MAX_VALUE,maxShowHeight:Number.MAX_VALUE,showLength:!1};var o=e;const h=XE.Tool;class n extends o{constructor(i,t){super(i,t),this._onlyMove=!0,this._fixedPositionsNum=2,this._positions=new Array(6).fill(0).map(()=>[0,0,0]),this._leftArrowPosition1=[0,0,0],this._rightArrowPosition1=[0,0,0],this._leftArrowPosition2=[0,0,0],this._rightArrowPosition2=[0,0,0],this._leftArrowPosition3=[0,0,0],this._rightArrowPosition3=[0,0,0],this._leftArrowPosition4=[0,0,0],this._rightArrowPosition4=[0,0,0],this._leftArrowPosition5=[0,0,0],this._rightArrowPosition5=[0,0,0],this._leftArrowPosition6=[0,0,0],this._rightArrowPosition6=[0,0,0],this._leftArrowPosition7=[0,0,0],this._rightArrowPosition7=[0,0,0],this._polylinePositions=[],this._scratchHpr=[0,0,0],this._scratchPos=[0,0,0],this.disposers.push(XE.MVVM.watch(()=>[...this.positions.map(i=>[...i])],i=>{if(2===i.length){i[1][2]=i[0][2];const t=h.Math.geoDistance(i[0],i[1]);i[0];if(t>0){const s=h.hpr(i[0],i[1],this._scratchHpr);if(!s)return;for(let e=0;e<6;++e)h.Math.geoMove(i[0],s[0]+Cesium.Math.PI_OVER_THREE*e,t,this._positions[e]);return this._polylinePositions.length=0,h.Math.geoMove(this._positions[0],s[0]+7*Math.PI/6,.1*t,this._leftArrowPosition1),h.Math.geoMove(this._positions[0],s[0]-7*Math.PI/6,.1*t,this._rightArrowPosition1),h.Math.geoMove(this._positions[1],s[0]+3*Math.PI/2,.1*t,this._leftArrowPosition2),h.Math.geoMove(this._positions[1],s[0]-Math.PI/6,.1*t,this._rightArrowPosition2),h.Math.geoMove(this._positions[4],s[0]+Math.PI/2,.1*t,this._leftArrowPosition3),h.Math.geoMove(this._positions[4],s[0]+Math.PI/6,.1*t,this._rightArrowPosition3),h.Math.geoMove(this._positions[5],s[0]-5*Math.PI/6,.1*t,this._leftArrowPosition4),h.Math.geoMove(this._positions[5],s[0]+5*Math.PI/6,.1*t,this._rightArrowPosition4),h.Math.geoMove(this._positions[2],s[0]-Math.PI/6,.1*t,this._leftArrowPosition5),h.Math.geoMove(this._positions[2],s[0]-Math.PI/2,.1*t,this._rightArrowPosition5),h.Math.geoMove(this._positions[3],s[0]+Math.PI/2,.1*t,this._leftArrowPosition6),h.Math.geoMove(this._positions[3],s[0]+Math.PI/6,.1*t,this._rightArrowPosition6),h.Math.geoMove(this.positions[0],s[0]+7*Math.PI/6,.1*t,this._leftArrowPosition7),h.Math.geoMove(this.positions[0],s[0]-(Math.PI+Math.PI/6),.1*t,this._rightArrowPosition7),this._polylinePositions.push([...i[0]]),this._polylinePositions.push([...this._positions[0]]),this._polylinePositions.push([...this._leftArrowPosition1]),this._polylinePositions.push([...this._positions[0]]),this._polylinePositions.push([...this._rightArrowPosition1]),this._polylinePositions.push([...this._positions[0]]),this._polylinePositions.push([...this._positions[1]]),this._polylinePositions.push([...this._leftArrowPosition2]),this._polylinePositions.push([...this._positions[1]]),this._polylinePositions.push([...this._rightArrowPosition2]),this._polylinePositions.push([...this._positions[1]]),this._polylinePositions.push([...this._positions[4]]),this._polylinePositions.push([...this._leftArrowPosition3]),this._polylinePositions.push([...this._positions[4]]),this._polylinePositions.push([...this._rightArrowPosition3]),this._polylinePositions.push([...this._positions[4]]),this._polylinePositions.push([...this._positions[5]]),this._polylinePositions.push([...this._leftArrowPosition4]),this._polylinePositions.push([...this._positions[5]]),this._polylinePositions.push([...this._rightArrowPosition4]),this._polylinePositions.push([...this._positions[5]]),this._polylinePositions.push([...this._positions[2]]),this._polylinePositions.push([...this._leftArrowPosition5]),this._polylinePositions.push([...this._positions[2]]),this._polylinePositions.push([...this._rightArrowPosition5]),this._polylinePositions.push([...this._positions[2]]),this._polylinePositions.push([...this._positions[3]]),this._polylinePositions.push([...this._leftArrowPosition6]),this._polylinePositions.push([...this._positions[3]]),this._polylinePositions.push([...this._rightArrowPosition6]),this._polylinePositions.push([...this._positions[3]]),this._polylinePositions.push([...i[0]]),this._polylinePositions.push([...this._leftArrowPosition7]),this._polylinePositions.push([...i[0]]),this._polylinePositions.push([...this._rightArrowPosition7]),this._polyline.positions=this._polylinePositions,void(this._polylineShow=!0)}}this._polylineShow=!1}))}}n.registerType(n,"GeoSectorSearch");var r=n;const a=XE.Tool;class l extends o{constructor(i,t){super(i,t),this._leftArrowPosition=[0,0,0],this._rightArrowPosition=[0,0,0],this.disposers.push(XE.MVVM.watch(()=>[...this.positions.map(i=>[...i])],i=>{const t=i.length,s=a.Math.distance(i);if(t<2)return void(this._polylineShow=!1);const e=a.Math.hpr(i[t-1],i[t-2]);e&&(a.Math.geoMove(i[t-1],e[0]+Math.PI/6,.1*s,this._leftArrowPosition),a.Math.geoMove(i[t-1],e[0]-Math.PI/6,.1*s,this._rightArrowPosition),i.push([...this._leftArrowPosition]),i.push([...i[t-1]]),i.push([...this._rightArrowPosition]),i.push([...i[t-1]]),this._polyline.positions=i,this._polylineShow=!0)}))}}l.registerType(l,"GeoPolylineArrow");var p=l;class c extends XE.Obj.PlotBase{constructor(i,t){super(i,t),this._onlyMove=!1,this._fixedPositionsNum=void 0,XE.MVVM.extend(this,{_polygonShow:!0}),this._polygon=new XE.Obj.Polygon(i),this.disposers.push(()=>{this._polygon=this._polygon&&this._polygon.destroy()}),this._polygon.show=this._polygonShow&&this.show,XE.Earth.Interaction.Picking.registerPickingParent(this._polygon,this),this._position=Cesium.Cartesian3.fromRadians(0,0,0),this.area=0;let s=Cesium.Cartesian3.distance(i.czm.viewer.camera.positionWC,this._position);this._billboardEnt=i.czm.viewer.entities.add({name:"面积显示",position:this._position,label:{text:this.area+"平方米",translucencyByDistance:new Cesium.NearFarScalar(5*s,2,30*s,0),style:Cesium.LabelStyle.FILL_AND_OUTLINE,font:"35px 楷体",fillColor:Cesium.Color.WHITE.withAlpha(.9),outlineColor:Cesium.Color.BLACK.withAlpha(.9),outlineWidth:6,scale:.5,disableDepthTestDistance:1e9,pixelOffset:new Cesium.Cartesian2(0,-10),verticalOrigin:Cesium.VerticalOrigin.BOTTOM}});const e=()=>{this._polygon.show=this._polygonShow&&this.show,this._polygon.width=this.width,this._polygon.color=this.color,this._polygon.ground=this.ground,this._polygon.outline.width=this.outlineWidth,this._polygon.outline.color=this.outlineColor,this._polygon.outline.show=this.outlineShow,this._polygon.depthTest=this.depthTest,this._polygon.extrudedHeight=this.extrudedHeight,this._polygon.minShowHeight=this.minShowHeight,this._polygon.maxShowHeight=this.maxShowHeight,this.area=this._polygon._totalArea;let i=this._polygon._totalArea;const t=this.positions.map(i=>Cesium.Cartesian3.fromRadians(...i));let s=Cesium.BoundingSphere.fromPoints(t);this._billboardEnt.show=this.showArea&&this.show,this._billboardEnt.position=s.center,"GeoRectangle"==this.xbsjType||"GeoCircle"==this.xbsjType?this.positions.length>1&&i&&(this._billboardEnt.label.text=o(i)):this.positions.length>2&&i&&(this._billboardEnt.label.text=o(i))};function o(i){return i>1e6?(i/1e6).toFixed(3)+"平方千米":i>1e4?(i/1e4).toFixed(3)+"公顷":i>100?(i/100).toFixed(3)+"公亩":i.toFixed(3)+"平方米"}e(),this.disposers.push(XE.MVVM.watch(()=>({show:this._polygonShow&&this.show,width:this.width,color:[...this.color],ground:this.ground,outlineWidth:this.outlineWidth,outlineColor:this.outlineColor,outlineShow:this.outlineShow,depthTest:this.depthTest,extrudedHeight:this.extrudedHeight,minShowHeight:this.minShowHeight,maxShowHeight:this.maxShowHeight,showArea:this.showArea,positions:[...this.positions]}),()=>e()),()=>{i.czm.viewer.entities.remove(this._billboardEnt)})}get onlyMove(){return this._onlyMove}get fixedPositionsNum(){return this._fixedPositionsNum}flyTo(){this._polygon.flyTo()}}c.defaultOptions={positions:[],show:!0,color:[0,1,0,.1],outlineWidth:2,outlineColor:[0,1,0,1],outlineShow:!0,depthTest:!1,extrudedHeight:null,minShowHeight:-Number.MAX_VALUE,maxShowHeight:Number.MAX_VALUE,showArea:!1};var u=c;XE.Tool;class d extends u{constructor(i,t){super(i,t),this._onlyMove=!0,this._fixedPositionsNum=2,this._polygonPositions=[],this._hpr=[0,0,0],this.disposers.push(XE.MVVM.watch(()=>[...this.positions.map(i=>[...i])],i=>{if(i.length<2)return void(this._polygonShow=!1);this._polygonPositions.length=0,this._polygonPositions.push(i[0][0],i[1][1]),this._polygonPositions.push(i[0][0],i[0][1]),this._polygonPositions.push(i[1][0],.5*(i[0][1]+i[1][1]));const t=i[1][0]-i[0][0];this._polygonPositions.push(i[0][0]+.01*t,.5*(i[0][1]+i[1][1])),this._polygonPositions.push(i[0][0]+.01*t,i[1][1]),this._polygon.positions=this._polygonPositions,this._polygon.height=i[0][2],this._polygonShow=!0}))}}d.registerType(d,"GeoTriFlag");var m=d;const _=XE.Tool;class g extends o{constructor(i,t){super(i,t),this._leftArrowPosition=[0,0,0],this._rightArrowPosition=[0,0,0],this._positions=[],this.disposers.push(XE.MVVM.watch(()=>({positions:[...this.positions.map(i=>[...i])],slices:this.slices}),({positions:i,slices:t})=>{const s=i.length,e=_.Math.distance(i);if(s<2)return void(this._polylineShow=!1);this._positions.length=0,_.Math.interpolatePositions(i,t,!1,this._positions);const o=this._positions.length,h=_.Math.hpr(this._positions[o-1],this._positions[o-2]);h?(_.Math.geoMove(this._positions[o-1],h[0]+Math.PI/6,.05*e,this._leftArrowPosition),_.Math.geoMove(this._positions[o-1],h[0]-Math.PI/6,.05*e,this._rightArrowPosition),this._positions.push([...this._leftArrowPosition]),this._positions.push([...this._positions[o-1]]),this._positions.push([...this._rightArrowPosition]),this._positions.push([...this._positions[o-1]]),this._polyline.positions=this._positions,this._polylineShow=!0):this._polylineShow=!1}))}}g.defaultOptions={slices:100},g.registerType(g,"GeoCurveArrow");var y=g;const P=XE.Tool;class M extends u{constructor(i,t){super(i,t),this._onlyMove=!0,this._fixedPositionsNum=4,this._keyPositions=new Array(50).fill(0).map(i=>[0,0,0]),this._bottomCurcePositions=new Array(20).fill(0).map(i=>[0,0,0]),this._leftArrowLeftPositions=new Array(20).fill(0).map(i=>[0,0,0]),this._leftArrowRightPositions=new Array(20).fill(0).map(i=>[0,0,0]),this._rightArrowLeftPositions=new Array(20).fill(0).map(i=>[0,0,0]),this._rightArrowRightPositions=new Array(20).fill(0).map(i=>[0,0,0]),this._polygonPositions=[],this._hpr=[0,0,0],this.disposers.push(XE.MVVM.watch(()=>[...this.positions.map(i=>[...i])],i=>{const t=i.length;if(t<3||3===t&&P.Math.hasSamePosition(i))return void(this._polygonShow=!1);this._keyPositions[0].splice(0,3,...i[0]),this._keyPositions[1].splice(0,3,...i[1]),this._keyPositions[2].splice(0,3,...i[2]),4===i.length?this._keyPositions[3].splice(0,3,...i[3]):(P.Math.geoLerp(i[0],i[2],.5,this._keyPositions[3]),P.Math.geoLerp(i[1],this._keyPositions[3],2,this._keyPositions[3]));const s=this._keyPositions[0],e=this._keyPositions[1],o=this._keyPositions[2],h=this._keyPositions[3],n=P.Math.geoLerp(s,e,.5,this._keyPositions[4]),r=P.Math.geoLerp(o,h,.5,this._keyPositions[5]),a=P.Math.geoLerp(n,r,.1,this._keyPositions[6]);P.Math.Bezier.bezier2(s,a,e,19,this._bottomCurcePositions);const l=P.Math.geoDistance(s,e),p=e,c=o,u=P.Math.geoLerp(n,r,.3,this._keyPositions[7]),d=P.Math.hpr(p,c,this._hpr)[0],m=P.Math.geoMove(c,Math.PI+d,.1*l,this._keyPositions[8]),_=P.Math.geoMove(m,d-.5*Math.PI,.04*l,this._keyPositions[9]),g=P.Math.geoMove(m,d+.5*Math.PI,.04*l,this._keyPositions[10]),y=P.Math.geoLerp(_,g,-.5,this._keyPositions[11]),M=P.Math.geoLerp(_,g,1.5,this._keyPositions[12]),f=P.Math.geoLerp(_,u,.5,this._keyPositions[13]),w=P.Math.geoLerp(g,p,.5,this._keyPositions[14]),C=(P.Math.geoLerp(f,w,.3,this._keyPositions[15]),P.Math.geoLerp(f,w,1.3,this._keyPositions[16]));P.Math.Bezier.bezier2(p,C,g,19,this._rightArrowRightPositions);const S=P.Math.geoLerp(n,r,.3,this._keyPositions[17]),v=h,x=s,E=P.Math.hpr(x,v,this._hpr)[0],b=P.Math.geoMove(v,Math.PI+E,.1*l,this._keyPositions[18]),T=P.Math.geoMove(b,E-.5*Math.PI,.04*l,this._keyPositions[19]),A=P.Math.geoMove(b,E+.5*Math.PI,.04*l,this._keyPositions[20]),X=P.Math.geoLerp(T,A,-.5,this._keyPositions[21]),I=P.Math.geoLerp(T,A,1.5,this._keyPositions[22]),O=P.Math.geoLerp(T,x,.5,this._keyPositions[23]),L=P.Math.geoLerp(A,S,.5,this._keyPositions[24]),V=P.Math.geoLerp(O,L,-.3,this._keyPositions[25]);P.Math.geoLerp(O,L,.7,this._keyPositions[26]);P.Math.Bezier.bezier3(_,e,s,A,19,this._leftArrowRightPositions),P.Math.Bezier.bezier2(T,V,x,19,this._leftArrowLeftPositions),this._polygonPositions.length=0,this._bottomCurcePositions.forEach(i=>{this._polygonPositions.push(i[0],i[1])}),this._rightArrowRightPositions.forEach(i=>this._polygonPositions.push(i[0],i[1])),this._polygonPositions.push(M[0],M[1]),this._polygonPositions.push(c[0],c[1]),this._polygonPositions.push(y[0],y[1]),this._leftArrowRightPositions.forEach(i=>this._polygonPositions.push(i[0],i[1])),this._polygonPositions.push(I[0],I[1]),this._polygonPositions.push(v[0],v[1]),this._polygonPositions.push(X[0],X[1]),this._leftArrowLeftPositions.forEach(i=>this._polygonPositions.push(i[0],i[1])),this._polygon.positions=this._polygonPositions,this._polygon.height=i[0][2],this._polygonShow=!0}))}}M.registerType(M,"GeoDoubleArrow");var f=M;const w=XE.Tool,C=new Array(360).fill(0).map(i=>[0,0,0]),S=[];class v extends u{constructor(i,t){super(i,t),this._onlyMove=!0,this._fixedPositionsNum=2,this._polygonPositions=new Array(4).fill(0).map(i=>[0,0,0]),this._pgPositions=[],this._nextPosition=[0,0,0],this.disposers.push(XE.MVVM.watch(()=>({ps:[...this.positions.map(i=>[...i])],rotation:this.rotation}),()=>{const{positions:i,rotation:t}=this;if(i.length<2)return void(this._polygonShow=!1);const s=i,e=Math.min,o=Math.max,h=s[0][2];if(w.Math.geoDistance(s[0],s[1])<=0)return;const n=[.5*(s[0][0]+s[1][0]),.5*(s[0][1]+s[1][1]),.5*(s[0][2]+s[1][2])],r=[e(s[0][0],s[1][0]),e(s[0][1],s[1][1]),h],a=[o(s[0][0],s[1][0]),e(s[0][1],s[1][1]),h],l=[o(s[0][0],s[1][0]),o(s[0][1],s[1][1]),h],p=[e(s[0][0],s[1][0]),o(s[0][1],s[1][1]),h];C.length=0,C.push(r,a,l,p);for(let i of C){const s=w.Math.geoDistance(n,i),e=w.Math.hpr(n,i);e&&w.Math.geoMove(n,e[0]+=t,s,i)}S.length=0,C.forEach(i=>{S.push(i[0],i[1])}),this._polygon.positions=S,this._polygon.height=h,this._polygonShow=!0}))}}v.defaultOptions={rotation:0},v.registerType(v,"GeoRectangle");var x=v;const E=XE.Tool,b=new Array(360).fill(0).map(i=>[0,0,0]),T=[];class A extends u{constructor(i,t){super(i,t),this._onlyMove=!0,this._fixedPositionsNum=2,this._polygonPositions=new Array(4).fill(0).map(i=>[0,0,0]),this._pgPositions=[],this._nextPosition=[0,0,0],this.disposers.push(XE.MVVM.watch(()=>({positions:[...this.positions.map(i=>[...i])],rotation:this.rotation,width:this.width,height:this.height}),({positions:i,rotation:t,width:s,height:e})=>{if(i.length<=0)return void(this._polygonShow=!1);const o=i[0];b.length=0,E.Math.geoMove(o,t,.5*s,this._nextPosition),E.Math.geoMove(this._nextPosition,t-.5*Math.PI,.5*e,this._nextPosition),b.push([...this._nextPosition]),E.Math.geoMove(o,t,.5*-s,this._nextPosition),E.Math.geoMove(this._nextPosition,t-.5*Math.PI,.5*e,this._nextPosition),b.push([...this._nextPosition]),E.Math.geoMove(o,t,.5*-s,this._nextPosition),E.Math.geoMove(this._nextPosition,t+.5*Math.PI,.5*e,this._nextPosition),b.push([...this._nextPosition]),E.Math.geoMove(o,t,.5*s,this._nextPosition),E.Math.geoMove(this._nextPosition,t+.5*Math.PI,.5*e,this._nextPosition),b.push([...this._nextPosition]),T.length=0,b.forEach(i=>{T.push(i[0],i[1])}),this._polygon.positions=T,this._polygon.height=i[0][2],this._polygonShow=!0}))}}A.defaultOptions={rotation:0,width:2e5,height:1e5},A.registerType(A,"GeoRectangle2");var X=A;const I=XE.Tool,O=new Array(360).fill(0).map(i=>[0,0,0]),L=[];class V extends u{constructor(i,t){super(i,t),this._onlyMove=!0,this._fixedPositionsNum=2,this.disposers.push(XE.MVVM.watch(()=>({positions:[...this.positions.map(i=>[...i])],holeRadius:this.holeRadius}),({positions:i,holeRadius:t})=>{if(i.length<2)return void(this._polygonShow=!1);const s=I.Math.geoDistance(i[0],i[1]);if(!I.Math.hpr(i[0],i[1]))return;for(let t=0;t<360;t++)I.Math.geoMove(i[0],t*Math.PI/180,s,O[t]);if(L.length=0,O.forEach(i=>{L.push(i[0],i[1])}),this._polygon.positions=L,this.holeRadius>0&&this.holeRadius<s){for(let t=0;t<360;t++)I.Math.geoMove(i[0],t*Math.PI/180,this.holeRadius,O[t]);L.length=0,O.forEach(i=>{L.push(i[0],i[1])}),this._polygon.holePositions=L}this._polygon.height=i[0][2],this._polygonShow=!0}))}}V.defaultOptions={holeRadius:0},V.registerType(V,"GeoCircle");var k=V;const z=XE.Tool,R=new Array(360).fill(0).map(i=>[0,0,0]),W=[];class j extends u{constructor(i,t){super(i,t),this._onlyMove=!0,this._fixedPositionsNum=1,this.disposers.push(XE.MVVM.watch(()=>({positions:[...this.positions.map(i=>[...i])],radius:this.radius,holeRadius:this.holeRadius,slice:this.slice}),({positions:i,radius:t,holeRadius:s,slice:e})=>{if(i.length<=0)return void(this._polygonShow=!1);const o=t;if(!(o<=0||e<=2)){for(let t=0;t<e;t++)z.Math.geoMove(i[0],t*Math.PI/180,o,R[t]);if(W.length=0,R.forEach(i=>{W.push(i[0],i[1])}),this._polygon.positions=W,s>0&&s<o){for(let t=0;t<e;t++)z.Math.geoMove(i[0],t*Math.PI/180,this.holeRadius,R[t]);W.length=0,R.forEach(i=>{W.push(i[0],i[1])}),this._polygon.holePositions=W}this._polygon.height=i[0][2],this._polygonShow=!0}}))}}j.defaultOptions={radius:2e5,holeRadius:0,slice:360},j.registerType(j,"GeoCircle2");var H=j;XE.Tool;class D extends u{constructor(i,t){super(i,t),this._pgPositions=[],this.disposers.push(XE.MVVM.watch(()=>[...this.positions.map(i=>[...i])],i=>{i.length<=1||(this._pgPositions.length=0,i.forEach(i=>{this._pgPositions.push(i[0],i[1])}),this._polygon.positions=this._pgPositions,this._polygon.height=i[0][2])}))}}D.registerType(D,"GeoPolygon");var G=D;XE.Tool;class B extends XE.Core.XbsjCzmObj{constructor(i,t){super(i,t),this.disposers.push(XE.Earth.Interaction.InteractionProperty.registerPositionEditing(this._earth,this,{positionEditingProperty:"editing"})),this.disposers.push(XE.Earth.Interaction.InteractionProperty.registerPositionPicking(this._earth,this,{positionPickingProperty:"creating"})),this._pin=new XE.Obj.Pin(i),this.disposers.push(()=>this._pin=this._pin&&this._pin.destroy()),this.disposers.push(XE.MVVM.watch(()=>{this._pin.position=[...this.position],this._pin.viewDistance=this.viewDistance,this._pin.scale=this.scale,this._pin.near=this.near,this._pin.far=this.far,this._pin.disableDepthTestDistance=this.disableDepthTestDistance,this._pin.enabled=this.enabled,this._pin.cameraAttached=this.cameraAttached,this._pin.attachedPathGuid=this.attachedPathGuid})),this.disposers.push(XE.MVVM.bind(this,"cameraAttached",this,"_pin.cameraAttached")),this._div=document.createElement("div"),this._div.id=this._pin.guid,this._div.innerHTML=this.innerHTML,this._div.style.position="absolute",this._div.style.pointerEvents="none";let s=this._pin;this.disposers.push(XE.MVVM.watch(()=>[...s.winPos],i=>{this._div.style.left=i[0]+"px",this._div.style.bottom=i[3]+"px"})),i.czm.viewer.container.appendChild(this._div),this.disposers.push(XE.MVVM.watch(()=>({cameraPosition:[...i.camera.position],near:this.near,far:this.far,position:[...this.position],enabled:this.enabled}),i=>{let t=XE.Tool.Math.distance([i.position,i.cameraPosition]);i.enabled&&i.near<=t&&t<=i.far?this._div.style.display="block":this._div.style.display="none"})),this._pin.show=!1,this.defaultImgUrl=function(){return"./assets/dialog.png"},this.innerHTML="<div\n        style=\"height:50px;width:100px;left:-76px;\n        bottom:0px;position: absolute;color: white;\n        background-size: 100% 100%;padding: 5px;\n        border-radius: 5px;cursor:pointer;\n        background-image:url('"+this.defaultImgUrl()+"');\">\n    标记文字\n    </div>",this.disposers.push(XE.MVVM.watch(()=>{this._div.innerHTML=this.innerHTML}))}flyTo(){this._pin.flyTo()}destroy(){return this._div&&this._div.parentNode.removeChild(this._div),super.destroy()}}B.defaultOptions={position:[0,0,0],viewDistance:100,scale:1,near:0,cameraAttached:!1,attachedPathGuid:"",far:Number.MAX_VALUE,disableDepthTestDistance:Number.MAX_VALUE,show:!1,innerHTML:"",defaultImgUrl:Function},B.registerType(B,"GeoPin");var N=B;XE.Tool;class F extends u{constructor(i,t){super(i,t),this._onlyMove=!0,this._fixedPositionsNum=2,this._polygonPositions=[],this._hpr=[0,0,0],this.disposers.push(XE.MVVM.watch(()=>[...this.positions.map(i=>[...i])],i=>{if(i.length<2)return void(this._polygonShow=!1);this._polygonPositions.length=0,this._polygonPositions.push(i[0][0],i[1][1]),this._polygonPositions.push(i[0][0],i[0][1]),this._polygonPositions.push(i[1][0],i[0][1]),this._polygonPositions.push(i[1][0],.5*(i[0][1]+i[1][1]));const t=i[1][0]-i[0][0];this._polygonPositions.push(i[0][0]+.01*t,.5*(i[0][1]+i[1][1])),this._polygonPositions.push(i[0][0]+.01*t,i[1][1]),this._polygon.positions=this._polygonPositions,this._polygon.height=i[0][2],this._polygonShow=!0}))}}F.registerType(F,"GeoRightAngleFlag");var U=F;const q=XE.Tool;class Q extends u{constructor(i,t){super(i,t),this._onlyMove=!0,this._fixedPositionsNum=2,this._polygonPositions=[],this._hpr=[0,0,0],this._keyPositions=new Array(50).fill(0).map(i=>[0,0,0]),this._bottomCurcePositions=new Array(20).fill(0).map(i=>[0,0,0]),this._sbottomCurcePositions=new Array(20).fill(0).map(i=>[0,0,0]),this._tbottomCurcePositions=new Array(20).fill(0).map(i=>[0,0,0]),this._fbottomCurcePositions=new Array(20).fill(0).map(i=>[0,0,0]),this.disposers.push(XE.MVVM.watch(()=>[...this.positions.map(i=>[...i])],i=>{if(i.length<2)return void(this._polygonShow=!1);this._keyPositions[0].splice(0,3,...i[0]),this._keyPositions[1].splice(0,3,...i[1]),this._polygonPositions.length=0,this._polygonPositions.push(i[0][0],i[1][1]),this._polygonPositions.push(i[0][0],i[0][1]);const t=i[1][0]-i[0][0],s=[i[0][0],i[0][1],0],e=[.5*(i[0][0]+i[1][0]),i[0][1],0],o=[.5*(i[0][0]+i[1][0])-2*t,i[0][1]-.8*t,0],h=[i[0][0],i[0][1]-t,0],n=q.Math.geoLerp(s,e,.9,this._keyPositions[4]),r=q.Math.geoLerp(o,h,.9,this._keyPositions[5]),a=q.Math.geoLerp(n,r,.2,this._keyPositions[6]);q.Math.Bezier.bezier2(s,a,e,19,this._bottomCurcePositions),this._bottomCurcePositions.forEach(i=>{this._polygonPositions.push(i[0],i[1])});const l=[.5*(i[0][0]+i[1][0]),i[0][1],0],p=[i[1][0],i[0][1],0],c=[.5*(i[0][0]+i[1][0])+t,i[0][1]-.1*t+t,0],u=[i[0][0],i[0][1]-t,0],d=q.Math.geoLerp(l,p,.1,this._keyPositions[7]),m=q.Math.geoLerp(c,u,.1,this._keyPositions[8]),_=q.Math.geoLerp(d,m,.2,this._keyPositions[9]);q.Math.Bezier.bezier2(l,_,p,19,this._sbottomCurcePositions),this._sbottomCurcePositions.forEach(i=>{this._polygonPositions.push(i[0],i[1])}),this._polygonPositions.push(i[1][0],i[0][1]),this._polygonPositions.push(i[1][0],.5*(i[0][1]+i[1][1]));const g=[i[1][0],.5*(i[0][1]+i[1][1]),0],y=[.5*(i[0][0]+i[1][0]),.5*(i[0][1]+i[1][1]),0],P=[i[1][0]-t,.5*(i[0][1]+i[1][1])+.5*t,0],M=[i[1][0]-6*t,.5*(i[0][1]+i[1][1])+2*t,0],f=q.Math.geoLerp(g,y,.1,this._keyPositions[7]),w=q.Math.geoLerp(P,M,.1,this._keyPositions[8]),C=q.Math.geoLerp(f,w,.2,this._keyPositions[9]);q.Math.Bezier.bezier2(g,C,y,19,this._tbottomCurcePositions),this._tbottomCurcePositions.forEach(i=>{this._polygonPositions.push(i[0],i[1])});const S=[.5*(i[0][0]+i[1][0]),.5*(i[0][1]+i[1][1]),0],v=[i[0][0]+.01*t,.5*(i[0][1]+i[1][1]),0],x=[.5*(i[0][0]+i[1][0])+5*t,.5*(i[0][1]+i[1][1])-1.1*t,0],E=[i[0][0]+1.01*t,.5*(i[0][1]+i[1][1])-t,0],b=q.Math.geoLerp(S,v,.9,this._keyPositions[4]),T=q.Math.geoLerp(x,E,.9,this._keyPositions[5]),A=q.Math.geoLerp(b,T,.2,this._keyPositions[6]);q.Math.Bezier.bezier2(S,A,v,19,this._fbottomCurcePositions),this._fbottomCurcePositions.forEach(i=>{this._polygonPositions.push(i[0],i[1])}),this._polygonPositions.push(i[0][0]+.01*t,i[1][1]),this._polygon.positions=this._polygonPositions,this._polygon.height=i[0][2],this._polygonShow=!0}))}}Q.registerType(Q,"GeoCurveFlag");var Y=Q;XE.Tool;class K extends o{constructor(i,t){super(i,t),this.disposers.push(XE.MVVM.watch(()=>[...this.positions.map(i=>[...i])],i=>{this._polyline.positions=i}))}}K.registerType(K,"GeoPolyline");var Z=K;const J=XE.Tool;class $ extends o{constructor(i,t){super(i,t),this._onlyMove=!0,this._fixedPositionsNum=3,this._polylinePositions=new Array(360).fill(0).map(i=>[0,0,0]),this._pgPositions=[],this._nextPosition=[0,0,0],this.disposers.push(XE.MVVM.watch(()=>[...this.positions.map(i=>[...i])],i=>{if(i.length<3)return void(this._polylineShow=!1);const t=J.Math.geoDistance(i[0],i[1]);this._polylinePositions.length=0,this._polylinePositions.push([...i[1]]);const s=J.Math.hpr(i[0],i[1]),e=J.Math.hpr(i[0],i[2]);var o=0;o=s[0]>=e[0]?(s[0]-e[0])*(180/Math.PI):(s[0]-e[0]+2*Math.PI)*(180/Math.PI);for(var h=0;h<o;h++)J.Math.geoMove(i[0],s[0]-=Math.PI/180,t,this._nextPosition),this._polylinePositions.push([...this._nextPosition]);this._polyline.positions=this._polylinePositions,this._polylineShow=!0}))}}$.registerType($,"GeoArc");var ii=$;const ti=XE.Tool;class si extends o{constructor(i,t){super(i,t),this._onlyMove=!0,this._fixedPositionsNum=3,this._bezierPositions=new Array(20).fill(0).map(i=>[0,0,0]),this.disposers.push(XE.MVVM.watch(()=>[...this.positions.map(i=>[...i])],i=>{i.length<3||ti.Math.hasSamePosition(i)?this._polylineShow=!1:(ti.Math.Bezier.bezier2(i[0],i[1],i[2],19,this._bezierPositions),this._polyline.positions=this._bezierPositions,this._polylineShow=!0)}))}}si.registerType(si,"GeoBezier2");var ei=si;const oi=XE.Tool;class hi extends o{constructor(i,t){super(i,t),this._onlyMove=!0,this._fixedPositionsNum=4,this._bezierPositions=new Array(20).fill(0).map(i=>[0,0,0]),this.disposers.push(XE.MVVM.watch(()=>[...this.positions.map(i=>[...i])],i=>{i.length<4||oi.Math.hasSamePosition(i)?this._polylineShow=!1:(oi.Math.Bezier.bezier3(i[0],i[1],i[2],i[3],19,this._bezierPositions),this._polyline.positions=this._bezierPositions,this._polylineShow=!0)}))}}hi.registerType(hi,"GeoBezier3");var ni=hi;const ri=XE.Tool;class ai extends u{constructor(i,t){super(i,t),this._onlyMove=!0,this._fixedPositionsNum=3,this._polygonPositions=new Array(360).fill(0).map(i=>[0,0,0]),this._pgPositions=[],this._nextPosition=[0,0,0],this.disposers.push(XE.MVVM.watch(()=>[...this.positions.map(i=>[...i])],i=>{if(i.length<3)return void(this._polygonShow=!1);const t=ri.Math.geoDistance(i[0],i[1]);this._polygonPositions.length=0,this._polygonPositions.push([...i[0]]),this._polygonPositions.push([...i[1]]);const s=ri.Math.hpr(i[0],i[1]),e=ri.Math.hpr(i[0],i[2]);if(!s||!e)return;var o=0;o=s[0]>=e[0]?(s[0]-e[0])*(180/Math.PI):(s[0]-e[0]+2*Math.PI)*(180/Math.PI);for(var h=0;h<o;h++)ri.Math.geoMove(i[0],s[0]-=Math.PI/180,t,this._nextPosition),this._polygonPositions.push([...this._nextPosition]);this._pgPositions.length=0,this._polygonPositions.forEach(i=>{this._pgPositions.push(i[0],i[1])}),this._polygon.positions=this._pgPositions,this._polygon.height=i[0][2],this._polygonShow=!0}))}}ai.registerType(ai,"GeoSector");var li=ai;const pi=XE.Tool;class ci extends u{constructor(i,t){super(i,t),this._onlyMove=!0,this._fixedPositionsNum=1,this._polygonPositions=new Array(360).fill(0).map(i=>[0,0,0]),this._pgPositions=[],this._nextPosition=[0,0,0],this.disposers.push(XE.MVVM.watch(()=>({positions:[...this.positions.map(i=>[...i])],radius:this.radius,startAngle:this.startAngle,angle:this.angle}),({positions:i,radius:t,startAngle:s,angle:e})=>{if(i.length<=0)return void(this._polygonShow=!1);if(e<=0||t<=0)return;this._polygonPositions.length=0,this._polygonPositions.push([...i[0]]);const o=Math.PI/180;for(let t=0;t<e;++t)pi.Math.geoMove(i[0]);const h=i[0];let n=s;const r=s+e;for(;n<r;)pi.Math.geoMove(h,n,t,this._nextPosition),this._polygonPositions.push([...this._nextPosition]),n+=o;pi.Math.geoMove(h,r,t,this._nextPosition),this._polygonPositions.push([...this._nextPosition]),this._pgPositions.length=0,this._polygonPositions.forEach(i=>{this._pgPositions.push(i[0],i[1])}),this._polygon.positions=this._pgPositions,this._polygon.height=i[0][2],this._polygonShow=!0}))}}ci.defaultOptions={radius:2e5,startAngle:0,angle:60*Math.PI/180},ci.registerType(ci,"GeoSector2");var ui=ci;const di=XE.Tool;class mi extends o{constructor(i,t){super(i,t),this._leftArrowPosition=[0,0,0],this._rightArrowPosition=[0,0,0],this._leftArrowPosition2=[0,0,0],this._rightArrowPosition2=[0,0,0],this.disposers.push(XE.MVVM.watch(()=>[...this.positions.map(i=>[...i])],i=>{const t=i.length;di.Math.distance(i);if(t<2||di.Math.hasSamePosition(i))this._polylineShow=!1;else{if(t>2)for(var s=t-1;s>0;s--){s>1&&(s%2==0?i[s][0]=i[s-1][0]:i[s][1]=i[s-1][1]);const t=di.Math.hpr(i[s],i[s-1]);if(!t)return;di.Math.geoMove(i[s],t[0]+Math.PI/6,.1*di.Math.distance(i[s-1],i[s]),this._leftArrowPosition),di.Math.geoMove(i[s],t[0]-Math.PI/6,.1*di.Math.distance(i[s-1],i[s]),this._rightArrowPosition),i.push([...i[s]]),i.push([...this._leftArrowPosition]),i.push([...i[s]]),i.push([...this._rightArrowPosition]),i.push([...i[s]])}this._polyline.positions=i,this._polylineShow=!0}}))}}mi.registerType(mi,"GeoParallelSearch");var _i=mi;const gi=XE.Tool;class yi extends o{constructor(i,t){super(i,t),this._positions=[],this.disposers.push(XE.MVVM.watch(()=>({positions:[...this.positions.map(i=>[...i])],slices:this.slices}),({positions:i,slices:t})=>{i.length<2?this._polylineShow=!1:(this._positions.length=0,gi.Math.interpolatePositions(i,t,!1,this._positions),this._polyline.positions=this._positions,this._polylineShow=!0)}))}}yi.defaultOptions={slices:100},yi.registerType(yi,"GeoCurve");var Pi=yi;let Mi=XE.Tool;function fi(i,t,s,e,o,h,n){let r=i*t,a=.7*r,l=Cesium.Cartesian3.distance(o[0],o[1]),p=!1;l<a&&(a=l,r=a/.7,p=!0);let c=Mi.Math.hpr(h[1],h[0],[0,0,0])[0],u=Mi.Math.geoMove(h[1],c,a,[0,0,0]),d=Mi.Math.geoMove(h[1],c,r,[0,0,0]),m=Mi.Math.hpr(u,h[1],[0,0,0])[0],_=Mi.Math.hpr(d,h[1],[0,0,0])[0];return n[0]=Mi.Math.geoMove(u,m-Cesium.Math.PI_OVER_TWO,s,[0,0,0]),n[4]=Mi.Math.geoMove(u,m+Cesium.Math.PI_OVER_TWO,s,[0,0,0]),n[1]=Mi.Math.geoMove(d,_-Cesium.Math.PI_OVER_TWO,s*e,[0,0,0]),n[3]=Mi.Math.geoMove(d,_+Cesium.Math.PI_OVER_TWO,s*e,[0,0,0]),n[2]=[...h[1]],p}const wi=XE.Tool;class Ci extends u{constructor(i,t){super(i,t),this._onlyMove=!0,this._polygonPositions=[],this.a={b:{c:5},bb:5},XE.MVVM.extend(this,{a:this.a},{a:XE.MVVM.reaction.observable.ref}),this.disposers.push(XE.MVVM.watch(()=>this.a,()=>{})),this.disposers.push(XE.MVVM.watch(()=>({minWidthScale:this.minWidthScale,dynamicWidthScale:this.dynamicWidthScale,arrowMaxHeightScale:this.arrowMaxHeightScale,arrowWingWidthScale:this.arrowWingWidthScale}),()=>{this.change(this.positions,this.minWidthScale,this.dynamicWidthScale,this.arrowMaxHeightScale,this.arrowWingWidthScale)})),this.disposers.push(XE.MVVM.watch(()=>[...this.positions.map(i=>[...i])],()=>{this.change(this.positions,this.minWidthScale,this.dynamicWidthScale,this.arrowMaxHeightScale,this.arrowWingWidthScale)}))}change(i,t,s,e,o){let h=[...i];const n=h.length;if(n<2||function(i,t){if(!i||!t)return!1;vi=0;for(let s=0;s<i.length;s++)if(vi=i[s]==t[s]?0:1,vi>0)return!1;return!0}(h[n-1],h[n-2]))return;let r=h.map(i=>Cesium.Cartesian3.fromRadians(...i,null,new Cesium.Cartesian3));this._polygonPositions.length=0;let a,l,p,c,u,d,m,_=[0,0,0],g=new Array(n).fill(0).map((i,t)=>(a=h[t-1],l=h[t+1],p=h[t],c=a?wi.Math.hpr(p,a,_)[0]:0,u=l?wi.Math.hpr(p,l,_)[0]:0,d=c&&u?2:1,m=(c+u)/d,m=c>u?m:m-Cesium.Math.PI,m<0?m+Cesium.Math.TWO_PI:m)),y=0,P=[];r.forEach((i,t)=>{a=r[t-1]||i,l=i,y+=Cesium.Cartesian3.distance(a,l),P.push(y)}),P=P.map(i=>y-i);const M=(s/=2)*y,f=(t/=2)*y;let w=new Array(P.length).fill(0).map((i,t)=>f+M*P[t]/y),C=[],S=fi(y,e,f,o,r.slice(-2),h.slice(-2),C),v=[],x=[];h.forEach((i,t)=>{0==t||t==n-1?(v.push(wi.Math.geoMove(i,g[t]+Cesium.Math.PI_OVER_TWO,w[t])),x.push(wi.Math.geoMove(i,g[t]-Cesium.Math.PI_OVER_TWO,w[t]))):(v.push(wi.Math.geoMove(i,g[t]-Cesium.Math.PI,w[t])),x.push(wi.Math.geoMove(i,g[t],w[t])))}),v.pop(),x.pop(),S&&(v.pop(),x.pop()),v.push(C[0]),x.push(C[C.length-1]);let E=wi.Math.interpolatePositions(v,20*n,!1,[]),b=wi.Math.interpolatePositions(x,20*n,!1,[]);E.forEach(i=>{this._polygonPositions.push(i[0],i[1])}),C.forEach(i=>{this._polygonPositions.push(i[0],i[1])});for(let i=b.length-1;i>=0;i--)this._polygonPositions.push(b[i][0],b[i][1]);this._polygon.positions=this._polygonPositions,this._polygon.height=h[0][2],this._polygonShow=!0}}Ci.registerType(Ci,"GeoArrow"),Ci.defaultOptions={minWidthScale:.06,dynamicWidthScale:.1,arrowMaxHeightScale:.15,arrowWingWidthScale:2};var Si=Ci;let vi;const xi=XE.Tool;class Ei extends u{constructor(i,t){super(i,t),this._onlyMove=!0,this._polygonPositions=[],this._fixedPositionsNum=2,this.disposers.push(XE.MVVM.watch(()=>({showType:this.showType}),()=>this.changeShowType())),this.disposers.push(XE.MVVM.watch(()=>({minWidthScale:this.minWidthScale,dynamicWidthScale:this.dynamicWidthScale,arrowMaxHeightScale:this.arrowMaxHeightScale,arrowWingWidthScale:this.arrowWingWidthScale}),()=>{this.change(this.positions,this.minWidthScale,this.dynamicWidthScale,this.arrowMaxHeightScale,this.arrowWingWidthScale)})),this.disposers.push(XE.MVVM.watch(()=>[...this.positions.map(i=>[...i])],()=>{this.change(this.positions,this.minWidthScale,this.dynamicWidthScale,this.arrowMaxHeightScale,this.arrowWingWidthScale)}))}changeShowType(){let i=bi[this.showType];Object.keys(i).forEach(t=>{this[t]=i[t]})}change(){if(this.positions.length<2||function(i,t){if(!i||!t)return!1;Ai=0;for(let s=0;s<i.length;s++)if(Ai=i[s]==t[s]?0:1,Ai>0)return!1;return!0}(this.positions[0],this.positions[1]))return;let i=this.positions.map(i=>Cesium.Cartesian3.fromRadians(...i,null,new Cesium.Cartesian3));this._polygonPositions.length=0;let t=xi.Math.geoDistance(...this.positions),s=xi.Math.hpr(...this.positions)[0],e=xi.Math.geoMove(this.positions[0],s,t*(1-this.arrowMaxHeightScale)),o=(this.dynamicWidthScale+this.minWidthScale)/2,h=this.minWidthScale/2,n=[xi.Math.geoMove(this.positions[0],s+Cesium.Math.PI_OVER_TWO,t*o),xi.Math.geoMove(this.positions[0],s-Cesium.Math.PI_OVER_TWO,t*o)],r=xi.Math.hpr(e,this.positions[1])[0],a=[xi.Math.geoMove(e,r+Cesium.Math.PI_OVER_TWO,t*h),xi.Math.geoMove(e,r-Cesium.Math.PI_OVER_TWO,t*h)],l=[xi.Math.hpr(n[0],a[0])[0],xi.Math.hpr(n[1],a[1])[0]],p=[xi.Math.geoDistance(a[0],n[0]),xi.Math.geoDistance(a[1],n[1])],c=[[],[]];for(let i=0;i<20;i++)c[0].push(xi.Math.geoMove(n[0],l[0],i*p[0]/20)),c[1].push(xi.Math.geoMove(n[1],l[1],i*p[1]/20));if(this.tail){let i=xi.Math.geoMove(this.positions[0],s,this.tailHeightScale*t);this._polygonPositions.push(i[0],i[1])}c[0].forEach(i=>{this._polygonPositions.push(i[0],i[1])});let u=[];fi(t,this.arrowMaxHeightScale,this.minWidthScale/2,this.arrowWingWidthScale,i,this.positions,u);for(let i=u.length-1;i>=0;i--)this._polygonPositions.push(u[i][0],u[i][1]);for(let i=c[1].length-1;i>=0;i--)this._polygonPositions.push(c[1][i][0],c[1][i][1]);this._polygon.positions=this._polygonPositions,this._polygon.height=this.positions[0][2],this._polygonShow=!0}}const bi={forkedTail:{minWidthScale:.06,dynamicWidthScale:.1,arrowMaxHeightScale:.15,arrowWingWidthScale:2,tail:!0},cusp:{minWidthScale:.06,dynamicWidthScale:.1,arrowMaxHeightScale:.15,arrowWingWidthScale:2,tail:!1},parallel:{minWidthScale:.12,dynamicWidthScale:0,arrowMaxHeightScale:.08,arrowWingWidthScale:2,tail:!1}};Ei.defaultOptions={showType:"forkedTail",positions:[],tailHeightScale:.15,...bi.forkedTail},Ei.registerType(Ei,"GeoSimpleArrow");var Ti=Ei;let Ai;let Xi=new Cesium.Cartesian3;XE.Tool;class Ii extends XE.Core.XbsjCzmObj{constructor(i,t){super(i,t),this.disposers.push(XE.Earth.Interaction.InteractionProperty.registerPositionEditing(this._earth,this,{positionEditingProperty:"positionEditing"})),this.disposers.push(XE.Earth.Interaction.InteractionProperty.registerPositionPicking(this._earth,this,{positionPickingProperty:"creating"})),this.disposers.push(XE.Earth.Interaction.InteractionProperty.registerRotationEditing(this._earth,this,{rotationEditingProperty:"rotationEditing"})),this._viewer=i.czm.viewer;let s=new Cesium.Cartesian3;Cesium.Cartesian3.fromRadians(...this.position,null,s),this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(s),this._updateCallback=()=>{},this._particleSystem=new Cesium.ParticleSystem({image:this.image,show:this.show&&this.enabled,startColor:new Cesium.Color(this.startColor[0],this.startColor[1],this.startColor[2],this.startColor[3]),endColor:new Cesium.Color(this.endColor[0],this.endColor[1],this.endColor[2],this.endColor[3]),startScale:this.startScale,endScale:this.endScale,minimumParticleLife:this.minimumParticleLife,maximumParticleLife:this.maximumParticleLife,minimumSpeed:this.minimumSpeed,maximumSpeed:this.maximumSpeed,imageSize:new Cesium.Cartesian2(this.particleSize,this.particleSize),emissionRate:this.emissionRate,lifetime:16,modelMatrix:this._modelMatrix,emitterModelMatrix:Cesium.Matrix4.IDENTITY,emitter:new Cesium.CircleEmitter(2),updateCallback:this._updateCallback}),this._viewer.scene.primitives.add(this._particleSystem),this.disposers.push(()=>{this._particleSystem&&(this._viewer.scene.primitives.remove(this._particleSystem),this._particleSystem=void 0)}),this.disposers.push(XE.MVVM.watch(()=>({startColor:[...this.startColor],endColor:[...this.endColor],image:this.image,emissionRate:this.emissionRate,maximumSpeed:this.maximumSpeed,minimumSpeed:this.minimumSpeed,minimumImageSize:this.minimumImageSize,maximumImageSize:this.maximumImageSize,minimumParticleLife:this.minimumParticleLife,maximumParticleLife:this.maximumParticleLife,show:this.show&&this.enabled}),()=>this.update())),this.disposers.push(XE.MVVM.watch(()=>({image:this.image}),()=>this.updateParticleSystem())),this.disposers.push(XE.MVVM.watch(()=>({particleSize:this.particleSize}),()=>this.updateParticleSize())),this.disposers.push(XE.MVVM.watch(()=>[...this.position,...this.rotation],()=>this.updateMatrix())),this.disposers.push(XE.MVVM.watch(()=>({gravity:this.gravity}),()=>{this._particleSystem.updateCallback=this.updateGravity(this.gravity)})),this.disposers.push(XE.MVVM.watch(()=>({emitterRadius:this.emitterRadius,emitterAngle:this.emitterAngle,emitterType:this.emitterType}),()=>this.updateEmitter()))}toBeFountain(){let i=Oi.fountain;this.changeShowType(i)}toBeSmoke(){let i=Oi.smoke;this.changeShowType(i)}changeShowType(i){Object.keys(i).forEach(t=>{this[t]=i[t]})}updateMatrix(){let i=new Cesium.Cartesian3,t=new Cesium.Matrix4;if(Cesium.Cartesian3.fromRadians(...this.position,null,i),!i.x&&!i.y&&!i.z)return;this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(i);let s=new Cesium.HeadingPitchRoll(...this.rotation),e=Cesium.Quaternion.fromHeadingPitchRoll(s,new Cesium.Quaternion);t=Cesium.Matrix4.fromTranslationQuaternionRotationScale(Cesium.Cartesian3.ZERO,e,new Cesium.Cartesian3(1,1,1),t),Cesium.Matrix4.multiply(this._modelMatrix,t,this._modelMatrix),this._particleSystem.modelMatrix=this._modelMatrix}updateParticleSize(){this._particleSystem.imageSize?(this._particleSystem.imageSize.x=this.particleSize,this._particleSystem.imageSize.y=this.particleSize,this._particleSystem.maximumImageSize.x=this.particleSize,this._particleSystem.maximumImageSize.y=this.particleSize,this._particleSystem.minimumImageSize.x=this.particleSize,this._particleSystem.minimumImageSize.y=this.particleSize):this._particleSystem.imageSize=new Cesium.Cartesian2(this.particleSize,this.particleSize)}updateParticleSystem(){this._particleSystem&&(this._viewer.scene.primitives.remove(this._particleSystem),this._particleSystem=void 0),this._particleSystem=new Cesium.ParticleSystem({image:this.image,show:this.show&&this.enabled,startColor:{red:this.startColor[0],green:this.startColor[1],blue:this.startColor[2],alpha:this.startColor[3]},endColor:{red:this.endColor[0],green:this.endColor[1],blue:this.endColor[2],alpha:this.endColor[3]},startScale:this.startScale,endScale:this.endScale,minimumParticleLife:this.minimumParticleLife,maximumParticleLife:this.maximumParticleLife,minimumSpeed:this.minimumSpeed,maximumSpeed:this.maximumSpeed,imageSize:new Cesium.Cartesian2(this.particleSize,this.particleSize),emissionRate:this.emissionRate,lifetime:16,modelMatrix:this._modelMatrix,emitterModelMatrix:Cesium.Matrix4.IDENTITY,emitter:this._emitter,updateCallback:this._updateCallback}),this._viewer.scene.primitives.add(this._particleSystem)}update(){this._particleSystem.startColor={red:this.startColor[0],green:this.startColor[1],blue:this.startColor[2],alpha:this.startColor[3]},this._particleSystem.endColor={red:this.endColor[0],green:this.endColor[1],blue:this.endColor[2],alpha:this.endColor[3]},this._particleSystem.startScale=this.startScale,this._particleSystem.endScale=this.endScale,this._particleSystem.emissionRate=this.emissionRate,this._particleSystem.minimumSpeed=this.minimumSpeed,this._particleSystem.maximumSpeed=this.maximumSpeed,this._particleSystem.minimumParticleLife=this.minimumParticleLife,this._particleSystem.maximumParticleLife=this.maximumParticleLife,this._particleSystem.show=this.show&&this.enabled}updateGravity(i){return this._updateCallback=(t,s)=>{Cesium.Cartesian3.normalize(t.position,Xi),Cesium.Cartesian3.multiplyByScalar(Xi,i*s,Xi),t.velocity=Cesium.Cartesian3.add(t.velocity,Xi,t.velocity)}}updateEmitter(){let i;if(i="BoxEmitter"!=this.emitterType?"ConeEmitter"==this.emitterType?this.emitterAngle:this.emitterRadius:new Cesium.Cartesian3(...new Array(3).fill(this.emitterRadius)),!this._particleSystem)return this._emitter=new Cesium[this.emitterType](i),this._emitter;this._particleSystem.emitter=new Cesium[this.emitterType](i),this._emitter=this._particleSystem.emitter}flyTo(){if(this._particleSystem){let i=Math.abs(this._particleSystem.minimumSpeed)>Math.abs(this._particleSystem.maximumSpeed)?Math.abs(this._particleSystem.minimumSpeed):Math.abs(this._particleSystem.maximumSpeed),t=Math.abs(this._particleSystem.minimumParticleLife)>Math.abs(this._particleSystem.maximumParticleLife)?Math.abs(this._particleSystem.minimumParticleLife):Math.abs(this._particleSystem.maximumParticleLife),s=new Cesium.Cartesian3;Cesium.Matrix4.getColumn(this._particleSystem.modelMatrix,3,s);let e=i*t,o=new Cesium.BoundingSphere(s,e);this._viewer.camera.flyToBoundingSphere(o,{duration:2})}}}const Oi={fountain:{gravity:10,minimumSpeed:10,maximumSpeed:15,gravity:-10,emitterRadius:.1,emissionRate:20,startColor:[1,1,1,1],endColor:[1,1,1,0],emitterType:"CircleEmitter",rotation:[0,Cesium.Math.PI_OVER_TWO,0]},smoke:{startColor:[.12549,.69804,.66667,.7],endColor:[1,1,1,0],rotation:[0,0,0],emissionRate:5,gravity:0,minimumParticleLife:2,maximumParticleLife:2,minimumSpeed:1,maximumSpeed:4,emitterRadius:2,emitterType:"CircleEmitter"}};Ii.defaultOptions={show:!0,enabled:!0,position:[1.6988083400554626,.6666896940162155,30],startScale:1,endScale:5,particleSize:25,image:"../../XbsjEarth-Plugins/plottingSymbol2/assets/SampleData/smoke.png",emitterAngle:1,...Oi.smoke},Ii.registerType(Ii,"ParticleSystem");var Li=Ii;let Vi;var ki=function(){if(!Vi){Vi=document.createElement("canvas"),Vi.width=20,Vi.height=20;var i=Vi.getContext("2d");i.beginPath(),i.arc(8,8,8,0,Cesium.Math.TWO_PI,!0),i.closePath(),i.fillStyle="rgb(255, 255, 255)",i.fill()}return Vi};new Cesium.Cartesian3;XE.Tool;class zi extends XE.Core.XbsjCzmObj{constructor(i,t){super(i,t),this.disposers.push(XE.Earth.Interaction.InteractionProperty.registerPositionEditing(this._earth,this,{positionEditingProperty:"editing"})),this.disposers.push(XE.Earth.Interaction.InteractionProperty.registerPositionPicking(this._earth,this,{positionPickingProperty:"creating"})),this._viewer=i.czm.viewer,this._modelMatrix=this._modelMatrix||Cesium.Matrix4.IDENTITY,this._position=new Cesium.Cartesian3,this._particleSystem=new Cesium.ParticleSystem({image:ki(),show:this.show&&this.enabled,startColor:{red:this.startColor[0],green:this.startColor[1],blue:this.startColor[2],alpha:this.startColor[3]},endColor:{red:this.endColor[0],green:this.endColor[1],blue:this.endColor[2],alpha:0},particleLife:this.particleLife,speed:this.radius/this.particleLife||0,imageSize:new Cesium.Cartesian2(7,7),bursts:[new Cesium.ParticleBurst({time:0,minimum:400,maximum:400})],emissionRate:0,lifetime:this.particleLife+this.burstInterval||2,modelMatrix:this._modelMatrix,emitter:new Cesium.SphereEmitter(.1)}),this._viewer.scene.primitives.add(this._particleSystem),this.disposers.push(()=>{this._particleSystem&&(this._viewer.scene.primitives.remove(this._particleSystem),this._particleSystem=void 0)}),this.disposers.push(XE.MVVM.watch(()=>({startColor:[...this.startColor],endColor:[...this.endColor],show:this.show&&this.enabled}),()=>this.updateColor())),this.disposers.push(XE.MVVM.watch(()=>({radius:this.radius,particleLife:this.particleLife,burstInterval:this.burstInterval}),()=>this.updateInitialVelocity())),this.disposers.push(XE.MVVM.watch(()=>({position:[...this.position]}),()=>this.updateModelMatrix()))}updateColor(){this._particleSystem.startColor={red:this.startColor[0],green:this.startColor[1],blue:this.startColor[2],alpha:this.startColor[3]},this._particleSystem.endColor={red:this.endColor[0],green:this.endColor[1],blue:this.endColor[2],alpha:this.endColor[3]},this._particleSystem.show=this.show&&this.enabled}updateModelMatrix(){Cesium.Cartesian3.fromRadians(...this.position,null,this._position),(this._position.x||this._position.y||this._position.z)&&(this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(this._position),this._particleSystem.modelMatrix=this._modelMatrix)}updateInitialVelocity(){this._initialVelocity=this.radius/this.particleLife,this._particleSystem.lifetime=this.particleLife+this.burstInterval,this._particleSystem.minimumParticleLife=this.particleLife,this._particleSystem.maximumParticleLife=this.particleLife,this._particleSystem.minimumSpeed=this._initialVelocity,this._particleSystem.maximumSpeed=this._initialVelocity}flyTo(){this.boundingSphere=new Cesium.BoundingSphere(this._position,this.radius),this._viewer.camera.flyToBoundingSphere(this.boundingSphere,{duration:2})}}zi.defaultOptions={show:!0,radius:200,particleLife:.8,burstInterval:1,startColor:[.75,0,.8,1],endColor:[.75,0,.8,0],position:[1.7,.6666896940162155,100]},zi.registerType(zi,"ParticleSystemFireWork");var Ri=zi;XE.Tool;class Wi extends XE.Core.XbsjCzmObj{constructor(i,t){super(i,t),this.disposers.push(XE.Earth.Interaction.InteractionProperty.registerPositionEditing(this._earth,this,{positionEditingProperty:"positionEditing"})),this.disposers.push(XE.Earth.Interaction.InteractionProperty.registerPositionPicking(this._earth,this,{positionPickingProperty:"creating"})),this.disposers.push(XE.Earth.Interaction.InteractionProperty.registerRotationEditing(this._earth,this,{rotationEditingProperty:"rotationEditing"})),this._viewer=i.czm.viewer,this._particleSystemList=[],this._modelMatrix=Cesium.Matrix4.clone(Cesium.Matrix4.IDENTITY,new Cesium.Matrix4),this._inverseModelMatrix=Cesium.Matrix4.clone(Cesium.Matrix4.IDENTITY,new Cesium.Matrix4),this._position=new Cesium.Cartesian3,this._colors=[],this.disposers.push(()=>{this._particleSystemList=this._particleSystemList.map(i=>{if(i)return this._viewer.scene.primitives.remove(i),i=void 0}),this._particleSystemList.length=0}),this.disposers.push(XE.MVVM.watch(()=>[...this.position,...this.rotation],()=>this.updateMatrix())),this.disposers.push(XE.MVVM.watch(()=>({show:this.show&&this.enabled,color:[...this.colors]}),()=>this.updateColors())),this.disposers.push(XE.MVVM.watch(()=>({emissionRate:this.emissionRate,particleSize:this.particleSize}),()=>this.updateCommon())),this.disposers.push(XE.MVVM.watch(()=>({radius:this.radius,rotate:this.rotate,height:this.height,particleLife:this.particleLife}),()=>this.update())),this.disposers.push(XE.MVVM.watch(()=>this.particleNumber,()=>{this.update(),this.updateParticleSystemList()})),this.updateParticleSystemList()}updateCommon(){this._particleSystemList.forEach(i=>{i.emissionRate=this.emissionRate,i.minimumImageSize.x=this.particleSize,i.minimumImageSize.y=this.particleSize,i.maximumImageSize.x=this.particleSize,i.maximumImageSize.y=this.particleSize})}updateColors(){this._colors.length=0;for(let i=0;i<this.colors.length;i+=4)this._colors.push(new Cesium.Color(this.colors[i],this.colors[i+1],this.colors[i+2],this.colors[i+3]));let i=this._colors.length,t=0;this._particleSystemList.forEach((s,e)=>{t=e%i,s.startColor=this._colors[t],s.endColor=this._colors[t].withAlpha(0),s.show=this.show&&this.enabled})}update(){this._radiuStep=this.radius/this.particleLife,this._rotateSpeed=this.rotate/this.particleLife,this._speed=this.height/this.particleLife,this.changeUpdateCallBack()}updateMatrix(){let i=new Cesium.Matrix4;if(Cesium.Cartesian3.fromRadians(...this.position,null,this._position),!this._position.x&&!this._position.y&&!this._position.z)return;this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(this._position);let t=new Cesium.HeadingPitchRoll(...this.rotation),s=Cesium.Quaternion.fromHeadingPitchRoll(t,new Cesium.Quaternion);i=Cesium.Matrix4.fromTranslationQuaternionRotationScale(Cesium.Cartesian3.ZERO,s,new Cesium.Cartesian3(1,1,1),i),Cesium.Matrix4.multiply(this._modelMatrix,i,this._modelMatrix),this._inverseModelMatrix=Cesium.Matrix4.inverse(this._modelMatrix,this._inverseModelMatrix),this._particleSystemList.forEach((i,t)=>{i.modelMatrix=this._modelMatrix}),this.changeUpdateCallBack()}changeUpdateCallBack(){this._particleSystemList.forEach((i,t)=>{i.updateCallback=this.updateCallback(this._radiuStep,this._rotateSpeed,Cesium.Math.TWO_PI*t/this.particleNumber,this._speed,this._inverseModelMatrix,this._modelMatrix)})}updateCallback(i,t,s,e,o,h){let n=new Cesium.Cartesian3;return(r,a)=>{a=Cesium.Math.clamp(a,0,.05),n=Cesium.Matrix4.multiplyByPoint(o,r.position,n),s+=a*t,s%=Cesium.Math.TWO_PI,n.x+=Math.cos(s)*i*a,n.y+=Math.sin(s)*i*a,n.z-=e*a,r.position=Cesium.Matrix4.multiplyByPoint(h,n,r.position)}}updateParticleSystemList(){let i;this._particleSystemList=this._particleSystemList.map(i=>{if(i)return this._viewer.scene.primitives.remove(i),i=void 0}),this._particleSystemList.length=0;for(let t=0;t<this.particleNumber;++t){i=t%this._colors.length;let s=this.updateCallback(this._radiuStep,this._rotateSpeed,Cesium.Math.TWO_PI*t/this.particleNumber,this._speed,this._inverseModelMatrix,this._modelMatrix);this._particleSystemList.push(new Cesium.ParticleSystem({image:ki(),show:this.show&&this.enabled,startColor:this._colors[i],endColor:this._colors[i].withAlpha(0),particleLife:this.particleLife,speed:5e-6,imageSize:new Cesium.Cartesian2(this.particleSize,this.particleSize),emissionRate:this.emissionRate,modelMatrix:this._modelMatrix,lifetime:.1,emitter:new Cesium.CircleEmitter(.01),updateCallback:s}))}this._particleSystemList.forEach(i=>{this._viewer.scene.primitives.add(i)})}flyTo(){this.boundingSphere=new Cesium.BoundingSphere(this._position,Math.sqrt(2*Math.pow(this.radius,2),Math.pow(this.height,2))),this._viewer.camera.flyToBoundingSphere(this.boundingSphere,{duration:2})}toBeCometTail(){this.colors=[...ji.comet.colors],this.rotate=ji.comet.rotate}toBeRocketThruster(){this.colors=[...ji.rocket.colors],this.rotate=ji.rocket.rotate}}Wi.defaultOptions={show:!0,particleSize:15,emissionRate:30,particleNumber:100,position:[1.67,.6,50],rotation:[0,0,0],colors:[.6,.6,.6,1,.6,.6,.9,.9,.5,.5,.7,.5],radius:30,rotate:.01,height:50,particleLife:3.5};const ji={rocket:{colors:[1,.5,.05,1,.9,.6,.01,1,.8,.05,.09,1,1,.05,.09,1],rotate:1},comet:{colors:[.6,.6,.6,1,.6,.6,.9,.9,.5,.5,.7,.5],rotate:.01}};Wi.registerType(Wi,"ParticleSystemTails");var Hi=Wi;let Di=function(i,t,s,e,o=20){let h,n,r,a,l,p,c,u=[];u.push(i);for(let d=1;d<o;d++)h=d/o,n=h*h,r=n*h,a=1-h,l=a*a,p=l*a,c=new Cesium.Cartesian3,c.x=i.x*p+3*t.x*l*h+3*s.x*a*n+e.x*r,c.y=i.y*p+3*t.y*l*h+3*s.y*a*n+e.y*r,c.z=i.z*p+3*t.z*l*h+3*s.z*a*n+e.z*r,u.push(c);return u.push(e),u},Gi=function(i,t,s,e){let o=Cesium.Cartesian3.distance(t,i);vector=Cesium.Cartesian3.subtract(t,i,new Cesium.Cartesian3),Cesium.Cartesian3.normalize(vector,vector);let h=Cesium.Cartesian3.multiplyByScalar(vector,o/3,new Cesium.Cartesian3),n=Cesium.Cartesian3.multiplyByScalar(vector,2*o/3,new Cesium.Cartesian3);Cesium.Cartesian3.add(i,h,h),Cesium.Cartesian3.add(i,n,n),s.push(h,n),e.push(vector)};XE.Tool;class Bi extends u{constructor(i,t){super(i,t),this._pgPositions=[],this.disposers.push(XE.MVVM.watch(()=>[...this.positions.map(i=>[...i])],()=>{let i=this.positions.filter(i=>{let t=!0;if(t)return i});const t=i.length;if(t<=2)return;if(function(i,t){if(!i||!t)return!1;Fi=0;for(let s=0;s<i.length;s++)if(Fi=i[s]==t[s]?0:1,Fi>0)return!1;return!0}(i[t-1],i[t-2]))return;this._pgPositions.length=0;let s=[];i.forEach(i=>{s.push(i)}),function(i,t=!1,s=20,e){if(i.length<3)return;let o,h,n,r=i.map(i=>Cesium.Cartesian3.fromRadians(...i,void 0,new Cesium.Cartesian3));e||(e=[]),o=r[0];let a,l,p,c=[],u=new Cesium.Cartesian3,d=new Cesium.Cartesian3,m=[];if(1==t)o=r[r.length-1],c=r.map((i,t)=>{h=i,n=r[t+1]||r[0],l=Cesium.Cartesian3.distance(o,h),p=Cesium.Cartesian3.distance(h,n),u=Cesium.Cartesian3.subtract(h,o,u),d=Cesium.Cartesian3.subtract(n,h,d),Cesium.Cartesian3.normalize(u,u),Cesium.Cartesian3.normalize(d,d),Cesium.Cartesian3.multiplyByScalar(u,l,u),Cesium.Cartesian3.multiplyByScalar(d,p,d),a=Cesium.Cartesian3.add(u,d,new Cesium.Cartesian3),Cesium.Cartesian3.normalize(a,a),o=h;let s=Cesium.Cartesian3.multiplyByScalar(a,.3*-l,new Cesium.Cartesian3),e=Cesium.Cartesian3.multiplyByScalar(a,.3*p,new Cesium.Cartesian3);return Cesium.Cartesian3.add(h,s,s),Cesium.Cartesian3.add(h,e,e),m.push(s,e),a}),m.push(m.shift());else{Gi(r[0],r[1],m,c);for(let i=1;i<r.length-1;i++){o=r[i-1],h=r[i],n=r[i+1],l=Cesium.Cartesian3.distance(o,h),p=Cesium.Cartesian3.distance(h,n),u=Cesium.Cartesian3.subtract(h,o,u),d=Cesium.Cartesian3.subtract(n,h,d),Cesium.Cartesian3.normalize(u,u),Cesium.Cartesian3.normalize(d,d),Cesium.Cartesian3.multiplyByScalar(u,l,u),Cesium.Cartesian3.multiplyByScalar(d,p,d),a=Cesium.Cartesian3.add(u,d,new Cesium.Cartesian3),Cesium.Cartesian3.normalize(a,a),o=h;let t=Cesium.Cartesian3.multiplyByScalar(a,.3*-l,new Cesium.Cartesian3),s=Cesium.Cartesian3.multiplyByScalar(a,.3*p,new Cesium.Cartesian3);Cesium.Cartesian3.add(h,t,t),Cesium.Cartesian3.add(h,s,s),m.push(t,s),c.push(a)}Gi(r[r.length-2],r[r.length-1],m,c)}for(let i=0;i<r.length;i++){let t=r[i]||r[r.length-1],o=r[i+1]||r[0],h=m[2*i]||m[m.length-2],n=m[2*i+1]||m[m.length-1];e.push(...Di(t,h,n,o,s))}return e=e.map(i=>{let t=Cesium.Cartographic.fromCartesian(i);return[t.longitude,t.latitude,t.height]})}(i,!0,20).forEach(i=>{this._pgPositions.push(i[0],i[1])}),this._polygon.positions=this._pgPositions,this._polygon.height=i[0][2]}))}}Bi.registerType(Bi,"GeoSmoothPolygon");var Ni=Bi;let Fi;XE.Obj.Plots=XE.Obj.Plots||{},XE.Obj.Plots.GeoSectorSearch=r,XE.Obj.Plots.GeoPolylineArrow=p,XE.Obj.Plots.GeoTriFlag=m,XE.Obj.Plots.GeoCurveArrow=y,XE.Obj.Plots.GeoDoubleArrow=f,XE.Obj.Plots.GeoRectangle=x,XE.Obj.Plots.GeoRectangle2=X,XE.Obj.Plots.GeoCircle=k,XE.Obj.Plots.GeoCircle2=H,XE.Obj.Plots.GeoPolygon=G,XE.Obj.Plots.GeoPin=N,XE.Obj.Plots.GeoRightAngleFlag=U,XE.Obj.Plots.GeoCurveFlag=Y,XE.Obj.Plots.GeoPolyline=Z,XE.Obj.Plots.GeoArc=ii,XE.Obj.Plots.GeoBezier2=ei,XE.Obj.Plots.GeoBezier3=ni,XE.Obj.Plots.GeoSector=li,XE.Obj.Plots.GeoSector2=ui,XE.Obj.Plots.GeoParallelSearch=_i,XE.Obj.Plots.GeoCurve=Pi,XE.Obj.Plots.GeoArrow=Si,XE.Obj.Plots.GeoSimpleArrow=Ti,XE.Obj.Plots.ParticleSystem=Li,XE.Obj.Plots.GeoSmoothPolygon=Ni,XE.Obj.Plots.ParticleSystemFireWork=Ri,XE.Obj.Plots.ParticleSystemTails=Hi}]);
//# sourceMappingURL=plottingSymbol.js.map